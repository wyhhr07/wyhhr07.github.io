<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>EPUB Reader</title>
    <script src="/reader/js/epub.min.js"></script>
    <style>
        body { margin: 0; }
        #viewer { height: 100vh; }
    </style>
</head>
<body>
    <div id="viewer"></div>
    <div id="error-message" style="display: none; color: red; text-align: center; padding: 20px;"></div>
    <script>
        const params = new URLSearchParams(window.location.search);
        const bookName = params.get('book');
        const bookPart = params.get('part');
        const bookPath = `../${bookName}`;
        const book = ePub(bookPath);
        const rendition = book.renderTo("viewer", {
            width: "100%",
            height: "100%"
        });

        rendition.display(bookPart).catch(error => {
            console.error('加载EPUB文件时出错:', error);
            document.getElementById('error-message').textContent = `加载EPUB文件时出错: ${error.message}`;
            document.getElementById('error-message').style.display = 'block';
        });

        book.ready.then(() => {
            console.log('EPUB文件已成功加载');
        }).catch(error => {
            console.error('EPUB文件加载失败:', error);
            document.getElementById('error-message').textContent = `EPUB文件加载失败: ${error.message}`;
            document.getElementById('error-message').style.display = 'block';
        });
    </script>
</body>
</html>